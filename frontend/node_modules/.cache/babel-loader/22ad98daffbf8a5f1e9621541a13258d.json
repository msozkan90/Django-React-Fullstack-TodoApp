{"ast":null,"code":"import _slicedToArray from\"C:/Users/OZCAN/Desktop/django_react/frontend/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import Alert from'../Alert';import Alert2 from'../Alert2';import APIService from'../APIService';import React,{useState,useEffect}from'react';import{useCookies}from'react-cookie';import{useNavigate}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function Register(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),username=_useState2[0],setUsername=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),password=_useState4[0],setPassword=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),all_users=_useState6[0],setAllUsers=_useState6[1];var _useState7=useState(),_useState8=_slicedToArray(_useState7,2),alert_msg=_useState8[0],setAlertMsg=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),alert_type=_useState10[0],setAlertType=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),alert2_msg=_useState12[0],setAlertMsg2=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),alert2_type=_useState14[0],setAlertType2=_useState14[1];var _useCookies=useCookies(['mytoken']),_useCookies2=_slicedToArray(_useCookies,2),token=_useCookies2[0],setToken=_useCookies2[1];var navigate=useNavigate();useEffect(function(){if(token['mytoken']!==\"undefined\"){console.log(\"register\");navigate('/');}},[token]);var getCookie=function getCookie(name){var cookieValue=null;if(document.cookie&&document.cookie!==''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=cookies[i].trim();if(cookie.substring(0,name.length+1)===name+'='){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break;}}}return cookieValue;};var getUsername=function getUsername(username){fetch('http://127.0.0.1:8000/account/username_check/').then(function(response){return response.json();}).then(function(data){return setAllUsers(data);});setAlertType(undefined);setAlertMsg(undefined);checkUsername(username);};var checkUsername=function checkUsername(username){var user_name=username;var db_username=all_users;if(user_name.length<5){console.log(\"5ten küçük\");setAlertType('danger');setAlertMsg('This field must be more than 5 characters.');}{db_username.map(function(user,index){if(user.username==user_name){console.log(user.username);setAlertType('danger');setAlertMsg('This username is already taken.');}else{console.log(\"user.username\");}});}};var handleUsername=function handleUsername(e){e.preventDefault();setUsername(e.target.value);getUsername(e.target.value);};var handlePassword=function handlePassword(e){e.preventDefault();setAlertType2(undefined);setAlertMsg2(undefined);setPassword(e.target.value);if(e.target.value.length<8){console.log(password.length);setAlertType2('danger');setAlertMsg2('This field must be more than 8 characters.');}};var handleSubmit=function handleSubmit(e){e.preventDefault();var csrftoken=getCookie('csrftoken');var body={username:username,password:password};var body_login={username:username,password:password};if(username==''){setAlertType('danger');setAlertMsg('This field cannot leave blank.');}else if(password==''){setAlertType2('danger');setAlertMsg2('This field cannot leave blank.');}else if(alert2_msg!==undefined||alert_msg!==undefined){console.log(\"ALERT\");}else{APIService.RegisterUser(body,csrftoken).then(function(resp){return APIService.LoginUser(body_login);}).then(function(resp){return setToken('mytoken',resp.token);}).catch(function(error){return console.log(error);});}};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col-md-3\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-md-6\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Register\"}),/*#__PURE__*/_jsxs(\"form\",{action:\"\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"id_username\",children:\"Username\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control \",onChange:handleUsername,type:\"text\",name:\"username\",maxLength:\"150\",autoFocus:\"\",id:\"id_username\"}),/*#__PURE__*/_jsx(Alert,{alert_msg:alert_msg,alert_type:alert_type})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"id_password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{className:\"form-control\",onChange:handlePassword,type:\"password\",name:\"password\",required:\"\",id:\"id_password\"}),/*#__PURE__*/_jsx(Alert2,{alert_msg:alert2_msg,alert_type:alert2_type})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-dark w-100\",children:\"Register\"})})]})]})]})}),\"\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\\xA0\"]});}export default Register;","map":{"version":3,"names":["Alert","Alert2","APIService","React","useState","useEffect","useCookies","useNavigate","Register","username","setUsername","password","setPassword","all_users","setAllUsers","alert_msg","setAlertMsg","alert_type","setAlertType","alert2_msg","setAlertMsg2","alert2_type","setAlertType2","token","setToken","navigate","console","log","getCookie","name","cookieValue","document","cookie","cookies","split","i","length","trim","substring","decodeURIComponent","getUsername","fetch","then","response","json","data","undefined","checkUsername","user_name","db_username","map","user","index","handleUsername","e","preventDefault","target","value","handlePassword","handleSubmit","csrftoken","body","body_login","RegisterUser","resp","LoginUser","catch","error"],"sources":["C:/Users/OZCAN/Desktop/django_react/frontend/src/pages/Register.jsx"],"sourcesContent":["import Alert from '../Alert';\r\nimport Alert2 from '../Alert2';\r\nimport APIService from '../APIService';\r\n\r\nimport React, {useState, useEffect} from 'react'\r\nimport {useCookies} from 'react-cookie';\r\n\r\nimport {useNavigate} from 'react-router-dom';\r\nfunction Register() {\r\n  const [username, setUsername] = useState('')\r\n  const [password, setPassword] = useState('')\r\n  const [all_users, setAllUsers] = useState([])\r\n  const [alert_msg, setAlertMsg] = useState()\r\n  const [alert_type, setAlertType] = useState()\r\n  const [alert2_msg, setAlertMsg2] = useState()\r\n  const [alert2_type, setAlertType2] = useState()\r\n\r\n  const [token, setToken] = useCookies(['mytoken'])\r\n  let navigate  = useNavigate()\r\n\r\n\r\n  useEffect(() => {\r\n    if(token['mytoken'] !== \"undefined\") {\r\n      console.log(\"register\")\r\n      navigate('/');\r\n    }\r\n}, [token])\r\n\r\n\r\n  const getCookie =(name) => {\r\n    var cookieValue = null;\r\n    if (document.cookie && document.cookie !== '') {\r\n        var cookies = document.cookie.split(';');\r\n        for (var i = 0; i < cookies.length; i++) {\r\n            var cookie = cookies[i].trim();\r\n\r\n            if (cookie.substring(0, name.length + 1) === (name + '=')) {\r\n                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return cookieValue;\r\n}\r\n\r\nconst getUsername =(username) =>{\r\n  \r\n  fetch('http://127.0.0.1:8000/account/username_check/')\r\n  .then(response => response.json())\r\n  .then(data => \r\n\r\n    setAllUsers(data),\r\n\r\n  )\r\n  setAlertType(undefined);\r\n  setAlertMsg(undefined);\r\n  checkUsername(username)\r\n\r\n}\r\n\r\nconst checkUsername = (username) =>{\r\nlet user_name=username\r\nlet db_username=all_users\r\nif(user_name.length < 5){\r\n  console.log(\"5ten küçük\")\r\n  setAlertType('danger');\r\n  setAlertMsg('This field must be more than 5 characters.');\r\n} \r\n           \r\n{db_username.map(function(user, index){\r\n  if(user.username == user_name){\r\n    console.log(user.username)\r\n    setAlertType('danger');\r\n    setAlertMsg('This username is already taken.');\r\n  }\r\n\r\n  else{\r\n    console.log(\"user.username\")\r\n\r\n  }\r\n\r\n})}\r\n\r\n}\r\n\r\nconst handleUsername = (e) =>{\r\n  e.preventDefault()\r\n  setUsername(e.target.value)\r\n  getUsername(e.target.value)\r\n}\r\n\r\nconst handlePassword = (e) =>{\r\n  e.preventDefault()\r\n  setAlertType2(undefined);\r\n  setAlertMsg2(undefined);\r\n  setPassword(e.target.value)\r\n  if (e.target.value.length < 8){\r\n    console.log(password.length)\r\n    setAlertType2('danger');\r\n    setAlertMsg2('This field must be more than 8 characters.');\r\n  }  \r\n\r\n}\r\n\r\n\r\n const handleSubmit = (e) =>{\r\n    e.preventDefault()\r\n    var csrftoken = getCookie('csrftoken')\r\n    let body = {username,password}\r\n    let body_login = {username,password}\r\n    if (username == '' ){\r\n      setAlertType('danger');\r\n      setAlertMsg('This field cannot leave blank.');\r\n\r\n    }\r\n    else if(password == ''){    \r\n        setAlertType2('danger');\r\n      setAlertMsg2('This field cannot leave blank.');\r\n    }\r\n    else if (alert2_msg !== undefined || alert_msg !== undefined){\r\n      console.log(\"ALERT\")\r\n    }\r\n    else{\r\n\r\n    APIService.RegisterUser(body,csrftoken)\r\n    .then(resp => APIService.LoginUser(body_login))\r\n    .then(resp => setToken('mytoken',resp.token))\r\n    .catch(error => console.log(error))\r\n    }\r\n\r\n  }\r\n  return (\r\n    <>\r\n    <div className=\"container\">\r\n      <div className=\"row\">\r\n        <div className=\"col-md-3\"></div>\r\n        <div className=\"col-md-6\">\r\n        <h3>Register</h3>\r\n          <form action=\"\" onSubmit={handleSubmit}>\r\n            <div className=\"form-group\">\r\n            <label htmlFor=\"id_username\">Username</label>\r\n            <input className=\"form-control \"  onChange={handleUsername} type=\"text\" name=\"username\" maxLength=\"150\" autoFocus=\"\"  id=\"id_username\" /> \r\n            < Alert alert_msg= {alert_msg}  alert_type= {alert_type}/>\r\n            </div>\r\n\r\n\r\n            <div className=\"form-group\">\r\n            <label htmlFor=\"id_password\">Password</label>\r\n\r\n            <input className=\"form-control\"  onChange={handlePassword} type=\"password\" name=\"password\" required=\"\" id=\"id_password\" />\r\n            < Alert2 alert_msg= {alert2_msg}  alert_type= {alert2_type}/>\r\n            </div>\r\n\r\n\r\n            <div className=\"form-group\">\r\n            <button className='btn btn-dark w-100'>Register</button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </div>\r\n        \r\n</>\r\n  )\r\n}\r\n\r\nexport default Register\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}